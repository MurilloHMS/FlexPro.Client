@implements IDisposable

@inject NavigationManager NavigationManager

<MudPaper Elevation="0" Class="py-3">
    <MudNavMenu Color="Color.Primary">
        <MudNavLink Href="" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">Página Inicial</MudNavLink>
        <AuthorizeView>
            <MudNavGroup Title="Gestão" Expanded="false" Icon="@Icons.Material.Filled.Domain">
                <MudNavGroup Title="Automóveis" Expanded="false" Icon="@Icons.Material.Filled.DirectionsCar">
                    <MudNavLink Href="veiculos" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.DirectionsCar">
                        Veículos
                    </MudNavLink>
                    <MudNavLink Href="consulta/veiculo" Match="NavLinkMatch.All"
                                Icon="@Icons.Material.Filled.Search">Consulta Veiculos
                    </MudNavLink>
                    <MudNavLink Href="revisoes" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.CarRepair">
                        Revisões
                    </MudNavLink>
                    <MudNavLink Href="abastecimentos" Match="NavLinkMatch.All"Icon="@Icons.Material.Filled.LocalGasStation">
                        Abastecimentos
                    </MudNavLink>
                </MudNavGroup>
                <MudNavGroup Title="Pessoas" Expanded="false" Icon="@Icons.Material.Filled.People">
                    <MudNavLink Href="funcionarios" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Group">
                        Funcionários
                    </MudNavLink>
                    <MudNavLink Href="parceiros" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.GroupAdd">
                        Parceiros
                    </MudNavLink>
                    <MudNavLink Href="entidades" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Business">Prestadores
                        e Fornecedores
                    </MudNavLink>
                </MudNavGroup>
                <MudNavLink Href="categorias" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Category">
                    Categorias
                </MudNavLink>
                </MudNavGroup>
            <MudNavGroup Title="Ferramentas" Expanded="false" Icon="@Icons.Material.Filled.Build">
                <MudNavGroup Title="PDF" Expanded="false" Icon="@Icons.Material.Filled.PictureAsPdf">
                    <MudNavLink Href="separarPDF" Match="NavLinkMatch.All" Icon="@Icons.Custom.FileFormats.FilePdf">Separar
                        PDF
                    </MudNavLink>
                </MudNavGroup>
                <MudNavGroup Title="Calculos" Expanded="false" Icon="@Icons.Material.Filled.Calculate">
                    <MudNavLink Href="CalculoTransportadoras" Match="NavLinkMatch.All"
                                Icon="@Icons.Material.Filled.EmojiTransportation">Calcular Transportadoras
                    </MudNavLink>
                    <MudNavLink Href="BoaSolucao" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Store">
                        Boa Solução
                    </MudNavLink>
                </MudNavGroup>
                <MudNavGroup Title="Coletas" Expanded="false" Icon="@Icons.Material.Filled.MergeType">
                    <MudNavLink Href="calcularICMS" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Calculate">
                        Coletar Dados ICMS
                    </MudNavLink>
                    <MudNavLink Href="coletarDadosNotasFiscais" Match="NavLinkMatch.All"
                                Icon="@Icons.Custom.FileFormats.FileCode">Coletar Dados Notas Fiscais
                    </MudNavLink>
                </MudNavGroup>
                <MudNavGroup Title="Renomear / Identificar" Expanded="false" Icon="@Icons.Material.Filled.DriveFileRenameOutline">
                    <MudNavLink Href="RenomearNotas" Match="NavLinkMatch.All"
                                Icon="@Icons.Material.Filled.DriveFileRenameOutline">Renomear Notas Fiscais
                    </MudNavLink>
                    <MudNavLink Href="/FlexPro/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.CreditCard">Separar
                        Dados Cartões
                    </MudNavLink>
                </MudNavGroup>
            </MudNavGroup>
            <MudNavGroup Title="Automações" Expanded="false" Icon="@Icons.Material.Filled.AutoMode">
                <MudNavGroup Title="Disparos" Expanded="false" Icon="@Icons.Material.Filled.Send">
                    <MudNavLink Href="Envios/Informativo" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Email">
                        Enviar Informativo Clientes
                    </MudNavLink>
                </MudNavGroup>
            </MudNavGroup>
            <MudNavGroup Title="Administrativo" Expanded="false" Icon="@Icons.Material.Filled.AdminPanelSettings">
                <MudNavLink Href="adminSite" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Web">Site Proauto
                    Kimium
                </MudNavLink>
                <MudNavLink Href="admin" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.AdminPanelSettings">
                    Geral
                </MudNavLink>
            </MudNavGroup>
        </AuthorizeView>
    </MudNavMenu>
</MudPaper>

@code {
    private string? currentUrl;

    protected override async Task OnInitializedAsync()
    {
        currentUrl = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        NavigationManager.LocationChanged += OnLocationChanged;
    }


    private void OnLocationChanged(object? sender, LocationChangedEventArgs e)
    {
        currentUrl = NavigationManager.ToBaseRelativePath(e.Location);
        StateHasChanged();
    }

    public void Dispose()
    {
        NavigationManager.LocationChanged -= OnLocationChanged;
    }

}